# Load AD module
Import-Module ActiveDirectory

# Define OU and output paths
$OU = "OU=Users,DC=yourdomain,DC=com"
$timestamp = Get-Date -Format "yyyy-MM-dd_HH-mm"
$reportDir = "C:\ADReports"
New-Item -ItemType Directory -Path $reportDir -Force | Out-Null

# Define output files
$allUsersFile = "$reportDir\AllUsers_$timestamp.csv"
$inactiveFile = "$reportDir\InactiveUsers_$timestamp.csv"
$disabledFile = "$reportDir\DisabledUsers_$timestamp.csv"
$lockedFile = "$reportDir\LockedUsers_$timestamp.csv"
$passwordExpiringFile = "$reportDir\PasswordExpiringSoon_$timestamp.csv"

# Get all users in OU
$users = Get-ADUser -SearchBase $OU -Filter * -Properties Name, SamAccountName, Enabled, LastLogonDate, PasswordNeverExpires, PasswordLastSet, AccountExpirationDate

